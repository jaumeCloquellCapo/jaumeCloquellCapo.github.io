<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Prevent re-renders on React</title><meta name="description" content="In most cases, React performance is not something you need to worry about. The core library does a ton of work under the hood to make sure everything is rendering efficiently. However, occasionally you can run into scenarios where your components are rendering more often&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/prevent-re-renders-on-react.html"><link rel="amphtml" href="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/amp/prevent-re-renders-on-react.html"><link rel="alternate" type="application/atom+xml" href="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/feed.xml"><link rel="alternate" type="application/json" href="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/feed.json"><meta property="og:title" content="Prevent re-renders on React"><meta property="og:image" content="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/media/posts/20/pexels-pixabay-87089.jpg"><meta property="og:site_name" content="jaumecloquellcapo"><meta property="og:description" content="In most cases, React performance is not something you need to worry about. The core library does a ton of work under the hood to make sure everything is rendering efficiently. However, occasionally you can run into scenarios where your components are rendering more often&hellip;"><meta property="og:url" content="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/prevent-re-renders-on-react.html"><meta property="og:type" content="article"><link rel="shortcut icon" href="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/media/website/favicon.ico" type="image/x-icon"><style>:root{--body-font:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";--heading-font:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";--logo-font:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";--menu-font:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol"}</style><link rel="stylesheet" href="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/assets/css/style.css?v=070d93baee55611c69660b27e7d8e9db"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/prevent-re-renders-on-react.html"},"headline":"Prevent re-renders on React","datePublished":"2020-09-09T16:09","dateModified":"2020-09-10T12:47","image":{"@type":"ImageObject","url":"https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/media/posts/20/pexels-pixabay-87089.jpg","height":2231,"width":3000},"description":"In most cases, React performance is not something you need to worry about. The core library does a ton of work under the hood to make sure everything is rendering efficiently. However, occasionally you can run into scenarios where your components are rendering more often&hellip;","author":{"@type":"Person","name":"jaume cloquell capo"},"publisher":{"@type":"Organization","name":"jaume cloquell capo"}}</script></head><body><div class="site-container"><header class="top" id="js-header"><a class="logo" href="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/">jaumecloquellcapo</a><nav class="navbar js-navbar"><button class="navbar__toggle js-toggle" aria-label="Menu" aria-haspopup="true" aria-expanded="false"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">Menu</span></span></button><ul class="navbar__menu"><li><a href="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/" title="https://jaumecloquellcapo.github.io/jaumeCloquellCapo.github.io/" target="_self">Home</a></li><li><a href="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/js/" target="_self">JS</a></li><li class="has-submenu"><a href="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/machine-learning/" target="_self" aria-haspopup="true">AI</a><ul class="navbar__submenu level-2" aria-hidden="true"><li><a href="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/abm/" target="_self">ABM</a></li><li><a href="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/nlp/" target="_self">NLP</a></li><li><a href="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/geneticalgorithms/" target="_self">Genetic Algorithms</a></li></ul></li><li><a href="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/golang/" target="_self">Golang</a></li></ul></nav><div class="search"><div class="search__overlay js-search-overlay"><div class="search__overlay-inner"><form action="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/search.html" class="search__form"><input class="search__input js-search-input" type="search" name="q" placeholder="search..." aria-label="search..." autofocus="autofocus"></form><button class="search__close js-search-close" aria-label="Close">Close</button></div></div><button class="search__btn js-search-btn" aria-label="Search"><svg role="presentation" focusable="false"><use xlink:href="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/assets/svg/svg-map.svg#search"/></svg></button></div></header><main><article class="post"><div class="hero"><figure class="hero__image hero__image--overlay"><img src="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/media/posts/20/pexels-pixabay-87089.jpg" srcset="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/media/posts/20/responsive/pexels-pixabay-87089-xs.jpg 300w, https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/media/posts/20/responsive/pexels-pixabay-87089-sm.jpg 480w, https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/media/posts/20/responsive/pexels-pixabay-87089-md.jpg 768w, https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/media/posts/20/responsive/pexels-pixabay-87089-lg.jpg 1024w, https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/media/posts/20/responsive/pexels-pixabay-87089-xl.jpg 1360w, https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/media/posts/20/responsive/pexels-pixabay-87089-2xl.jpg 1600w" sizes="(max-width: 1600px) 100vw, 1600px" loading="eager" height="2231" width="3000" alt=""></figure><header class="hero__content"><div class="wrapper"><div class="post__meta"><time datetime="2020-09-09T16:09">September 9, 2020</time></div><h1>Prevent re-renders on React</h1><div class="post__meta post__meta--author"><a href="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/authors/jaume-cloquell-capo/" class="feed__author invert">jaume cloquell capo</a></div></div></header></div><div class="wrapper post__entry"><p>In most cases, React performance is not something you need to worry about. The core library does a ton of work under the hood to make sure everything is rendering efficiently. However, occasionally you can run into scenarios where your components are rendering more often than they need to and slowing your site down.</p><p>To understand why hooks need to remember (memoize), we need to understand the motivation behind memoization in React. <a href="https://en.wikipedia.org/wiki/Memoization">Memoization</a> in programming is a computation strategy where functions remember the output of their previous execution, then uses it as a factor for the next computation. Usually, the function would try to run for each computation in a range of data but instead, it runs only once for the next range then factors the previous result.</p><p>In this article, I’ll demonstrate with a few simple examples why we need these hooks and when and how to use them. This is not an introduction to hooks, and you must be familiar with the <a href="https://reactjs.org/docs/hooks-reference.html#usestate">useState</a> hook to follow.</p><p> </p><h1 id="the-problem">Case Study</h1><p>Before we start, let’s introduce a helper button component. We’ll use <a href="https://reactjs.org/docs/react-api.html#reactmemo">React.memo</a> to turn it into a memoized component. This will force React to never re-render it, unless some of its properties change. We’ll also add a random colour as its background so we can track when it re-rerenders:</p><div class="post__iframe"><iframe loading="lazy" style="width: 100%; height: 500px; border: 0; border-radius: 4px; overflow: hidden;" src="https://codesandbox.io/embed/charming-night-6d34n?fontsize=14&amp;hidenavigation=1&amp;theme=dark" title="charming-night-6d34n" allow="accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking" sandbox="allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"></iframe></div><p>Now let’s look at the following simple app. It displays 2 numbers - a counter <code class="language-plaintext highlighter-rouge">Beta</code> and a <code class="language-plaintext highlighter-rouge">delta</code>. One button allows the user to increment <code class="language-plaintext highlighter-rouge">delta</code> by 1. A second button, allows the user to increment the counter by adding <code class="language-plaintext highlighter-rouge">delta</code> to it</p><p>In this example, any changes to data will cause <code><em>App</em></code> to re-render all of it's child components, including the <code>Button</code> component, even if title didn't change. . In this case it's probably not a big deal, but if <code><em>&lt;Button/&gt;</em></code> was performing some expensive computation every time it rendered we would want to make sure it was only rendering when necessary.</p><p>When using class based components, <code>PureComponent</code> will return the last rendered value if the passed in props are the same. There is also a <code><em>shouldComponentUpdate</em></code> function for more fine tuned control. When using functional components, React provides three methods of optimization that this article will be focusing on: <code>React.memo, useMemo,</code>and<code>useCallback.</code></p><h2>useCallback</h2><p><code><em>useCallback</em></code> can prevent unnecessary renders between parent and child components. It takes as an argument a function and returns a cached/memoized version of it.</p><div class="post__iframe"><iframe loading="lazy" style="width: 100%; height: 500px; border: 0; border-radius: 4px; overflow: hidden;" src="https://codesandbox.io/embed/beautiful-elbakyan-k6bx6?fontsize=14&amp;hidenavigation=1&amp;theme=dark" title="beautiful-elbakyan-k6bx6" allow="accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking" sandbox="allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"></iframe></div><p>Now <code class="language-plaintext highlighter-rouge">increment</code> will have the same value until <code class="language-plaintext highlighter-rouge">delta</code> changes, which will reduce the number of times renders. The <code class="language-plaintext highlighter-rouge">useCallback</code> hook has created a single cached version of <code class="language-plaintext highlighter-rouge">increment</code>, which encapsulates the <strong>initial value</strong> of <code class="language-plaintext highlighter-rouge">delta</code>. When <code class="language-plaintext highlighter-rouge">App</code> re-renders with different values for <code class="language-plaintext highlighter-rouge">delta</code>, <code class="language-plaintext highlighter-rouge">useCallback</code> returns the previous version of the <code class="language-plaintext highlighter-rouge">increment</code> function which keeps the old value of <code class="language-plaintext highlighter-rouge">delta</code> from the first rendering.</p><p>We need to tell <code class="language-plaintext highlighter-rouge">useCallback</code> to create new cached version of <code class="language-plaintext highlighter-rouge">increment</code> for every change of <code class="language-plaintext highlighter-rouge">delta</code> ( the the second argument)</p><h2>React.Memo</h2><p><code>React.memo</code> is a higher order component that memoizes the result of a function component. If a component returns the same result given the same props, wrapping it in memo can result in a performance boost. In other words useMemo caches a computed value. This is usefull when the computation requires significant resources and we don’t want to repeat it on every re-render<br><br>To see the differences  between  use <code>React.memo</code> or not, we define two components, header and subheader. The first components is wrapper using React.memo and the other not.  Also exist a button allows the user to increment a counter by <br><br>In this example, any changes to data will cause App to re-render all of it's child components, including the <code>&lt;SubHeader&gt;</code> and <code>&lt;Header&gt;</code> component, even if title didn't change. <br><br>We can come to the conclusion that this component not need to be rendered unless title changes, so it would be safe to wrap it in React.memo.‍Instead of skipping the render-step like in class based components, <code>React.memo</code> will reuse the last rendered result instead of calculating a new result.<br><br>This occur because  React.memo will reuse the last rendered result instead of calculating a new result in the case the <code>&lt;Header /&gt;</code> component</p><div class="post__iframe"><iframe loading="lazy" style="width: 100%; height: 500px; border: 0; border-radius: 4px; overflow: hidden;" src="https://codesandbox.io/embed/solitary-brook-l8704?fontsize=14&amp;hidenavigation=1&amp;theme=dark" title="solitary-brook-l8704" allow="accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking" sandbox="allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"></iframe></div><code class="css-b4nh06"></code><p></p><h2>useMemo</h2><p>While <code>React.memo</code> is a <a href="https://reactjs.org/docs/higher-order-components.html" class="css-19gwvxx">higher-order component</a> as it accepts a component and returns the new/memoized <strong class="css-0">component</strong>.<code>React.useMemo</code> is a <a href="https://reactjs.org/docs/hooks-intro.html">hook</a>(which is a function). It accepts a function and returns the memoized return value of the function you passed.<code class="language-js"></code></p><pre class="language-js prism-code language-javascript css-0"><span class="token plain">const value </span><span class="token operator">=</span> <span class="token maybe-class-name">React</span><span class="token punctuation">.</span><span class="token method function property-access">useMemo</span><span class="token punctuation">(<br></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token function">computeExpensiveValue</span><span class="token punctuation">(</span><span class="token plain">a</span><span class="token punctuation">,</span><span class="token plain"> b</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token plain">a</span><span class="token punctuation">,</span><span class="token plain"> b</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><code class="language-js"></code></pre><p>Using useMemo will memoize the result, so if widgets haven't changed since the component's last render it will skip the function call and return what it got last.‍</p><h2>Conclusions</h2><p id="c9ec" class="jy jz hb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv gt cq" data-selectable-paragraph="">The main difference between the <code class="css-b4nh06">React.useMemo</code> and <code class="css-b4nh06">React.useCallback</code> is that <code class="css-b4nh06">React.useCallback</code> returns a memoized callback and <code class="css-b4nh06">React.useMemo</code> returns a memoized value that is the result of the function parameter.</p><p id="e659" class="jy jz hb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv gt cq" data-selectable-paragraph="">If you have to process a lot of data, ‘useMemo’ is the perfect Hook as it will do the work once at the first render and then return a cached version on every other render.</p></div><footer class="wrapper post__footer"><p class="post__last-updated">This article was updated on September 10, 2020</p><ul class="post__tag"><li><a href="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/js/">JavaScript</a></li><li><a href="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/reactjs/">Reactjs</a></li></ul><div class="post__share"><a href="http://www.linkedin.com/shareArticle?url=https%3A%2F%2FjaumeCloquellCapo.github.io%2FjaumeCloquellCapo.github.io%2Fprevent-re-renders-on-react.html&amp;title=Prevent%20re-renders%20on%20React" class="js-share linkedin" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/assets/svg/svg-map.svg#linkedin"/></svg> <span>LinkedIn</span></a></div><div class="post__bio bio"><div class="bio__info"><h3 class="bio__name"><a href="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/authors/jaume-cloquell-capo/" class="invert" rel="author">jaume cloquell capo</a></h3></div></div></footer></article><nav class="post__nav"><div class="post__nav-inner"><div class="post__nav-prev"><svg width="1.041em" height="0.416em" aria-hidden="true"><use xlink:href="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/assets/svg/svg-map.svg#arrow-prev"/></svg> <a href="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/intersection-observer-api.html" class="invert post__nav-link" rel="prev"><span>Previous</span> Intersection Observer API in React</a></div><div class="post__nav-next"><a href="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/custom-error-types-with-golang.html" class="invert post__nav-link" rel="next"><span>Next</span> Returning Errors </a><svg width="1.041em" height="0.416em" aria-hidden="true"><use xlink:href="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/assets/svg/svg-map.svg#arrow-next"/></svg></div></div></nav><div class="post__related related"><div class="wrapper"><h2 class="h5 related__title">You should also read:</h2><article class="related__item"><div class="feed__meta"><time datetime="2020-09-03T18:11" class="feed__date">September 3, 2020</time></div><h3 class="h1"><a href="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/intersection-observer-api.html" class="invert">Intersection Observer API in React</a></h3></article></div></div><div class="post__comments"><div class="wrapper"><h2 class="h5">Comments</h2><div id="disqus_thread"></div><script>var disqus_config = function () {
                       this.page.url = 'https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/prevent-re-renders-on-react.html';
               		this.page.identifier = '20';
                   };
               
                   var disqus_loaded = false;
               
                   function publiiLoadDisqus() {
                       if(disqus_loaded) {
                           return false;
                       }
               
                       var top = document.getElementById('disqus_thread').offsetTop;
               
                       if (!disqus_loaded && (window.scrollY || window.pageYOffset) + window.innerHeight > top) {
                           disqus_loaded = true;
               
                           (function () {
                               var d = document, s = d.createElement('script');
                               s.src = 'https://'+'https-jaumecloquellcapo-github-io'.trim()+'.disqus.com/embed.js';
                               s.setAttribute('data-timestamp', +new Date());
                               (d.head || d.body).appendChild(s);
                           })();
                       }
                   }
               
                   publiiLoadDisqus();
               
                   window.onscroll = function() {
                       publiiLoadDisqus();
                   };</script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" target="_blank" rel="nofollow noopener noreferrer">comments powered by Disqus.</a></noscript></div></div></main><footer class="footer"><div class="footer__social"><a href="https://www.linkedin.com/in/jaume-cloquell-119765b7" aria-label="LinkedIn"><svg><use xlink:href="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/assets/svg/svg-map.svg#linkedin"/></svg></a></div><div class="footer__copyright"><p>jaume cloquell capo</p></div><button class="footer__bttop js-footer__bttop" aria-label="Back to top"><svg><title>Back to top</title><use xlink:href="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/assets/svg/svg-map.svg#toparrow"/></svg></button></footer></div><script>window.publiiThemeMenuConfig = {    
        mobileMenuMode: 'overlay',
        animationSpeed: 300,
        submenuWidth: 'auto',
        doubleClickTime: 500,
        mobileMenuExpandableSubmenus: true, 
        relatedContainerForOverlayMenuSelector: '.top',
   };</script><script defer="defer" src="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/assets/js/scripts.min.js?v=f4c4d35432d0e17d212f2fae4e0f8247"></script><script>var images = document.querySelectorAll('img[loading]');

        for (var i = 0; i < images.length; i++) {
            if (images[i].complete) {
                images[i].classList.add('is-loaded');
            } else {
                images[i].addEventListener('load', function () {
                    this.classList.add('is-loaded');
                }, false);
            }
        }</script><div class="cookie-popup js-cookie-popup cookie-popup--uses-badge"><h2>This website uses cookies</h2><p>Select which cookies to opt-in to via the checkboxes below; our website uses cookies to examine site traffic and user activity while on our site, for marketing, and to provide social media functionality. <a href="#not-specified">More details...</a></p><form><input id="gdpr-necessary" name="gdpr-necessary" checked="checked" disabled="disabled" type="checkbox"> <label for="gdpr-necessary">Required</label> <input id="gdpr-functions" name="gdpr-functions" type="checkbox"> <label for="gdpr-functions">Functionality</label> <input id="gdpr-analytics" name="gdpr-analytics" type="checkbox"> <label for="gdpr-analytics">Analytical</label> <input id="gdpr-marketing" name="gdpr-marketing" type="checkbox"> <label for="gdpr-marketing">Marketing</label><p class="cookie-popup__save-wrapper"><button type="submit" class="cookie-popup__save">Save</button></p></form><span class="cookie-popup-label">Cookie Policy</span></div><script>(function() {
                function addScript (src, inline) {
                    var newScript = document.createElement('script');

                    if (src) {
                        newScript.setAttribute('src', src);
                    }

                    if (inline) {
                        newScript.text = inline;
                    }

                    document.body.appendChild(newScript);
                }

                var popup = document.querySelector('.js-cookie-popup');
                var checkboxes = popup.querySelectorAll('input[type="checkbox"]');
                var save = popup.querySelector('button');
                var currentConfig = localStorage.getItem('publii-gdpr-allowed-cookies');
                var blockedScripts = document.querySelectorAll('script[type^="gdpr-blocker/"]');
                

                popup.addEventListener('click', function() {
                    if (!popup.classList.contains('cookie-popup--is-sticky')) {
                        popup.classList.add('cookie-popup--is-sticky');
                    }
                });

                save.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    popup.classList.remove('cookie-popup--is-sticky');
                    var allowedGroups = [];

                    for (var i = 0; i < checkboxes.length; i++) {
                        if (checkboxes[i].checked) {
                            var groupName = checkboxes[i].getAttribute('name').replace('gdpr-', '');
                            var scripts = document.querySelectorAll('script[type="gdpr-blocker/' + groupName + '"]');

                            for (var j = 0; j < scripts.length; j++) {
                                addScript(scripts[j].src, scripts[j].text);
                            }

                            allowedGroups.push(groupName);
                        }
                    }

                    localStorage.setItem('publii-gdpr-allowed-cookies', allowedGroups.join(','));
                    popup.classList.remove('cookie-popup--is-sticky');

                    setTimeout(function () {
                        if (currentConfig !== null) {
                            window.location.reload();
                        }
                    }, 250);
                });

                if (currentConfig === null) {
                    popup.classList.add('cookie-popup--is-sticky');
                    var checkedGroups = popup.querySelectorAll('input[type="checkbox"]:checked');

                    for (var i = 0; i < checkedGroups.length; i++) {
                        var allowedGroup = checkedGroups[i].name.replace('gdpr-', '');

                        if (allowedGroup !== '-' && allowedGroup !== '') {
                            var scripts = document.querySelectorAll('script[type="gdpr-blocker/' + allowedGroup + '"]');

                            for (var j = 0; j < scripts.length; j++) {
                                addScript(scripts[j].src, scripts[j].text);
                            }
                        }
                    }
                } else {
                    if (currentConfig !== '') {
                        var allowedGroups = currentConfig.split(',');
                        var checkedCheckboxes = popup.querySelectorAll('input[type="checkbox"]:checked');

                        for (var j = 0; j < checkedCheckboxes.length; j++) {
                            var name = checkedCheckboxes[j].name.replace('gdpr-', '');

                            if (allowedGroups.indexOf(name) === -1) {
                                checkedCheckboxes[j].checked = false;
                            }
                        }

                        for (var i = 0; i < allowedGroups.length; i++) {
                            var scripts = document.querySelectorAll('script[type="gdpr-blocker/' + allowedGroups[i] + '"]');
                            var checkbox = popup.querySelector('input[type="checkbox"][name="gdpr-' + allowedGroups[i] + '"]');

                            if (checkbox) {
                                checkbox.checked = true;
                            }

                            for (var j = 0; j < scripts.length; j++) {
                                addScript(scripts[j].src, scripts[j].text);
                            }
                        }
                    }
                }
            })();</script></body></html>