<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
            <title>Returning Errors - jaumecloquellcapo </title>
        <meta name="description" content="I’ve spent a lot of time thinking about the best way to handle errors in Go programs. I really wanted there to be a single way to do error handling, something that we could teach all Go programmers by rote, just as we might teach mathematics, or&hellip;" />
         
        <meta name="generator" content="Publii Open-Source CMS for Static Site" />
        <link rel="canonical" href="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/custom-error-types-with-golang.html">
        
        <link rel="alternate" type="application/atom+xml" href="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/feed.xml" />
<link rel="alternate" type="application/json" href="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/feed.json" />

        <meta property="og:title" content="Returning Errors" /><meta property="og:site_name" content="jaumecloquellcapo" /><meta property="og:description" content="I’ve spent a lot of time thinking about the best way to handle errors in Go programs. I really wanted there to be a single way to do error handling, something that we could teach all Go programmers by rote, just as we might teach mathematics, or&hellip;" /><meta property="og:url" content="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/custom-error-types-with-golang.html" /><meta property="og:type" content="article" />
	        <link rel="shortcut icon" href="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/media/website/favicon.ico" type="image/x-icon" />
        <style>:root{--body-font:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";--heading-font:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";--logo-font:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";--menu-font:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol"}</style>
        <link rel="stylesheet" href="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/assets/css/style.css?v=319e095e568825c63a55e23b71420052">
        <script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/custom-error-types-with-golang.html"},"headline":"Returning Errors","datePublished":"2020-12-08T13:50","dateModified":"2020-12-08T21:30","description":"I’ve spent a lot of time thinking about the best way to handle errors in Go programs. I really wanted there to be a single way to do error handling, something that we could teach all Go programmers by rote, just as we might teach mathematics, or&hellip;","author":{"@type":"Person","name":"jaume cloquell capo"},"publisher":{"@type":"Organization","name":"jaume cloquell capo"}}</script>
        
        
    </head>
    <body>
        <div class="site-container">
   <header class="top" id="js-header">
      <a class="logo" href="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/">
            jaumecloquellcapo
      </a>
            <nav class="navbar js-navbar">
               <button
                  class="navbar__toggle js-toggle"
                  aria-label="Menu"
                  aria-haspopup="true"
                  aria-expanded="false">
                  <span class="navbar__toggle-box">
                     <span class="navbar__toggle-inner">Menu</span>
                  </span>
               </button>
             <ul class="navbar__menu">
                      <li>
                        <a
                           href="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/"
                              title="https://jaumecloquellcapo.github.io/jaumeCloquellCapo.github.io/"
                              target="_self"
         >
                           Home
                       </a>
         
                  </li>
                      <li>
                        <a
                           href="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/js/"
                              target="_self"
         >
                           JS
                       </a>
         
                  </li>
                      <li class="has-submenu">
                        <a
                           href="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/machine-learning/"
                              target="_self"
                              aria-haspopup="true"
                           >
                           AI
                       </a>
         
                            <ul class="navbar__submenu level-2" aria-hidden="true" >
                                     <li>
                                       <a
                                          href="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/abm/"
                                             target="_self"
                        >
                                          ABM
                                      </a>
                        
                                 </li>
                                     <li>
                                       <a
                                          href="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/nlp/"
                                             target="_self"
                        >
                                          NLP
                                      </a>
                        
                                 </li>
                                     <li>
                                       <a
                                          href="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/geneticalgorithms/"
                                             target="_self"
                        >
                                          Genetic Algorithms
                                      </a>
                        
                                 </li>
                            </ul>
                  </li>
                      <li>
                        <a
                           href="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/golang/"
                              target="_self"
         >
                           Golang
                       </a>
         
                  </li>
             </ul>
            </nav>
         <div class="search">
            <div class="search__overlay js-search-overlay">
               <div class="search__overlay-inner">
                  <form action="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/search.html" class="search__form">
                     <input
                        class="search__input js-search-input"
                        type="search"
                        name="q"
                        placeholder="search..." 
                        aria-label="search..."
                        autofocus="autofocus"/>
                  </form>
                  <button class="search__close js-search-close" aria-label="Close">
                     Close
                  </button>
               </div>
            </div>
            <button class="search__btn js-search-btn" aria-label="Search">
               <svg role="presentation" focusable="false">
                  <use xlink:href="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/assets/svg/svg-map.svg#search"/>
               </svg>
            </button>
         </div>
   </header>
<main>
      <article class="post">
         <div class="hero">
             
                     <figure class="hero__image hero__image--overlay">
                         
                        <img
                           src="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/media/website/82-820639_big-dark-mountain-hd-wallpaper-1920x1280p-martin-garrix.jpg"
                               srcset="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/media/website/responsive/82-820639_big-dark-mountain-hd-wallpaper-1920x1280p-martin-garrix-xs.jpg 300w ,https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/media/website/responsive/82-820639_big-dark-mountain-hd-wallpaper-1920x1280p-martin-garrix-sm.jpg 480w ,https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/media/website/responsive/82-820639_big-dark-mountain-hd-wallpaper-1920x1280p-martin-garrix-md.jpg 768w ,https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/media/website/responsive/82-820639_big-dark-mountain-hd-wallpaper-1920x1280p-martin-garrix-lg.jpg 1024w ,https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/media/website/responsive/82-820639_big-dark-mountain-hd-wallpaper-1920x1280p-martin-garrix-xl.jpg 1360w ,https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/media/website/responsive/82-820639_big-dark-mountain-hd-wallpaper-1920x1280p-martin-garrix-2xl.jpg 1600w"   sizes="(max-width: 1600px) 100vw, 1600px" 
                            loading="eager"
                           alt="">
                         
                         
                     </figure>
             
            <header class="hero__content">
               <div class="wrapper">
                     <div class="post__meta">
                        <time datetime="2020-12-08T13:50">
                              December 8, 2020
                        </time>
                     </div>
                  <h1>
                     Returning Errors
                  </h1>
                     <div class="post__meta post__meta--author">
                           <a href="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/authors/jaume-cloquell-capo/" class="feed__author invert">jaume cloquell capo</a>
                     </div>
               </div>
            </header>
         </div>

         <div class="wrapper post__entry">           
            <p>I’ve spent a lot of time thinking about the best way to handle errors in Go programs. I really wanted there to be a single way to do error handling, something that we could teach all Go programmers by rote, just as we might teach mathematics, or the alphabet.</p>
<p>However, I have concluded that there is no single way to handle errors. Instead, I believe Go’s error handling can be classified into the two core strategies.</p>
<h1> </h1>
<h1 id="sentinel errors">Sentinel errors</h1>
<p>The first category of error handling is what I call <i>sentinel errors</i>. The name descends from the practice in computer programming of using a specific value to signify that no further processing is possible. </p>
<p>The default behavior returns an error with a message. An example is doing a sql query where we bubble up <code class="language-text">ErrNoRows</code> and return 404 for that error but 500 for other errors:</p>
<pre>res, err := r.db.Exec(query, UserSignUp.Name, UserSignUp.Password, UserSignUp.Email)<br>if err != nil {<br>   if err != sql.ErrNoRows {<br>      return 404<br>   }<br>   return 500<br>}</pre>
<p>These types of errors are called sentinel errors, the benefit is we can check against their type, but the downside is our http handler now needs to import the <code class="language-text">database/sql</code> package and we have no stack traces. </p>
<h1> </h1>
<h1>Error types</h1>
<p>Error types are the second form of Go error handling I want to discuss.</p>
<p>An error type is a type that you create that implements the error interface. This is where a package like <code class="language-text">errors</code> comes in.</p>
<pre>package error<br><br>type ErrorNotFound struct{ msg string }<br><br>func (e *ErrorNotFound) IsNotFound() bool { return true }<br>func (e *ErrorNotFound) Error() string    { return e.msg }<br><br>type IErrorNotFound interface {<br>   error<br>   IsNotFound() bool<br>}<br>func NewErrorNotFound(msg string) error {<br>   return &amp;ErrorNotFound{msg}<br>}</pre>
<p>A potential way to improve would be not requiring the handler to import <code class="language-text">ErrorNotFound</code>. A way to get around that would be to type assert on behavior instead of types. Where if our <code>ErrorNotFound</code> instead conformed to an interface, we could check against that, and just import an interface instead of a struct:</p>
<pre><br>...<br>   if err != nil {<br>      if err != sql.ErrNoRows {<br>         return model.User{}, error2.NewErrorNotFound(fmt.Sprintf("Error: User not found by email %s", email))<br>      }<br><br>      return model.User{}, err<br>   }<br><br>...</pre>
<pre>user, err := uc.service.GetUserById(id)<br>if err, ok := err.(errorNotFound.IErrorNotFound); ok &amp;&amp; err.IsNotFound() {<br>   c.Status(http.StatusNotFound)<br>}</pre>
<p><a href="https://github.com/jaumeCloquellCapo/go-api-boirplate" target="_blank" rel="noopener noreferrer">Github</a></p>            
         </div>

            <footer class="wrapper post__footer">

                     <p class="post__last-updated">
                        This article was updated on
                           December 8, 2020
                     </p>

                     <ul class="post__tag">
                           <li>
                              <a href="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/golang/">Golang</a>
                           </li>
                     </ul>

                  <div class="post__share">
                     
                     
                     
                     
                        <a
                           href="http://www.linkedin.com/shareArticle?url=https%3A%2F%2FjaumeCloquellCapo.github.io%2FjaumeCloquellCapo.github.io%2Fcustom-error-types-with-golang.html&amp;title=Returning%20Errors"
                           class="js-share linkedin"
                           rel="nofollow noopener noreferrer">
                           <svg class="icon" aria-hidden="true" focusable="false">
                              <use xlink:href="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/assets/svg/svg-map.svg#linkedin"/>
                           </svg>
                           <span>LinkedIn</span>
                        </a>
                     
                     
                  </div>

                  <div class="post__bio bio">
                        <div class="bio__info">
                           <h3 class="bio__name">
                              <a href="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/authors/jaume-cloquell-capo/" class="invert" rel="author">jaume cloquell capo</a>
                           </h3>

                        </div>
                  </div>
            </footer>
      </article>

            <nav class="post__nav">
               <div class="post__nav-inner">
                     <div class="post__nav-prev">
                        <svg width="1.041em" height="0.416em" aria-hidden="true">
                           <use xlink:href="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/assets/svg/svg-map.svg#arrow-prev"/>
                        </svg>

                        <a href="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/prevent-re-renders-on-react.html" class="invert post__nav-link" rel="prev">
                           <span>Previous</span>
                           Prevent re-renders on React
                        </a>
                     </div>
               </div>
            </nav>


         <div class="post__comments">
            <div class="wrapper">
               <h2 class="h5">
                  Comments
               </h2>
               <div id="disqus_thread"></div>
               <script>
                   var disqus_config = function () {
                       this.page.url = 'https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/custom-error-types-with-golang.html';
               		this.page.identifier = '22';
                   };
               
                   var disqus_loaded = false;
               
                   function publiiLoadDisqus() {
                       if(disqus_loaded) {
                           return false;
                       }
               
                       var top = document.getElementById('disqus_thread').offsetTop;
               
                       if (!disqus_loaded && (window.scrollY || window.pageYOffset) + window.innerHeight > top) {
                           disqus_loaded = true;
               
                           (function () {
                               var d = document, s = d.createElement('script');
                               s.src = 'https://'+'https-jaumecloquellcapo-github-io'.trim()+'.disqus.com/embed.js';
                               s.setAttribute('data-timestamp', +new Date());
                               (d.head || d.body).appendChild(s);
                           })();
                       }
                   }
               
                   publiiLoadDisqus();
               
                   window.onscroll = function() {
                       publiiLoadDisqus();
                   };
               </script>
               <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" target="_blank" rel="nofollow noopener noreferrer">comments powered by Disqus.</a></noscript>
            </div>
         </div>


</main>
<footer class="footer">
        <div class="footer__social">
                <a href="https://www.linkedin.com/in/jaume-cloquell-119765b7" aria-label="LinkedIn">
                    <svg>
                        <use xlink:href="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/assets/svg/svg-map.svg#linkedin"/>
                    </svg>
                </a>
        </div>
        <div class="footer__copyright">
            <p>jaume cloquell capo</p>
        </div>
       <button class="footer__bttop js-footer__bttop" aria-label="Back to top"> 
           <svg>
               <title>Back to top</title>
               <use xlink:href="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/assets/svg/svg-map.svg#toparrow" />
           </svg>
       </button>   
</footer>
</div>

<script>
   window.publiiThemeMenuConfig = {    
        mobileMenuMode: 'overlay',
        animationSpeed: 300,
        submenuWidth: 'auto',
        doubleClickTime: 500,
        mobileMenuExpandableSubmenus: true, 
        relatedContainerForOverlayMenuSelector: '.top',
   };
</script>
<script defer src="https://jaumeCloquellCapo.github.io/jaumeCloquellCapo.github.io/assets/js/scripts.min.js?v=f4c4d35432d0e17d212f2fae4e0f8247"></script>
    <script>        
        var images = document.querySelectorAll('img[loading]');

        for (var i = 0; i < images.length; i++) {
            if (images[i].complete) {
                images[i].classList.add('is-loaded');
            } else {
                images[i].addEventListener('load', function () {
                    this.classList.add('is-loaded');
                }, false);
            }
        }
    </script>


        <div class="cookie-popup js-cookie-popup  cookie-popup--uses-badge">
            <h2>This website uses cookies</h2>

            <p>
                Select which cookies to opt-in to via the checkboxes below; our website uses cookies to examine site traffic and user activity while on our site, for marketing, and to provide social media functionality.
                <a href="#not-specified">More details...</a>
            </p>
            
            <form>
                
                <input
                    id="gdpr-necessary"
                    name="gdpr-necessary"
                    checked="checked"
                    disabled="disabled"
                    type="checkbox">
                <label for="gdpr-necessary">
                    Required
                </label>
            <input
                id="gdpr-functions"
                name="gdpr-functions"
                
                type="checkbox">
            <label for="gdpr-functions">
                Functionality
            </label>
            <input
                id="gdpr-analytics"
                name="gdpr-analytics"
                
                type="checkbox">
            <label for="gdpr-analytics">
                Analytical
            </label>
            <input
                id="gdpr-marketing"
                name="gdpr-marketing"
                
                type="checkbox">
            <label for="gdpr-marketing">
                Marketing
            </label>

                <p class="cookie-popup__save-wrapper">
                    <button type="submit" class="cookie-popup__save">
                        Save
                    </button>
                </p>
            </form>

            <span class="cookie-popup-label">Cookie Policy</span>
        </div>
        <script>
            (function() {
                function addScript (src, inline) {
                    var newScript = document.createElement('script');

                    if (src) {
                        newScript.setAttribute('src', src);
                    }

                    if (inline) {
                        newScript.text = inline;
                    }

                    document.body.appendChild(newScript);
                }

                var popup = document.querySelector('.js-cookie-popup');
                var checkboxes = popup.querySelectorAll('input[type="checkbox"]');
                var save = popup.querySelector('button');
                var currentConfig = localStorage.getItem('publii-gdpr-allowed-cookies');
                var blockedScripts = document.querySelectorAll('script[type^="gdpr-blocker/"]');
                

                popup.addEventListener('click', function() {
                    if (!popup.classList.contains('cookie-popup--is-sticky')) {
                        popup.classList.add('cookie-popup--is-sticky');
                    }
                });

                save.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    popup.classList.remove('cookie-popup--is-sticky');
                    var allowedGroups = [];

                    for (var i = 0; i < checkboxes.length; i++) {
                        if (checkboxes[i].checked) {
                            var groupName = checkboxes[i].getAttribute('name').replace('gdpr-', '');
                            var scripts = document.querySelectorAll('script[type="gdpr-blocker/' + groupName + '"]');

                            for (var j = 0; j < scripts.length; j++) {
                                addScript(scripts[j].src, scripts[j].text);
                            }

                            allowedGroups.push(groupName);
                        }
                    }

                    localStorage.setItem('publii-gdpr-allowed-cookies', allowedGroups.join(','));
                    popup.classList.remove('cookie-popup--is-sticky');

                    setTimeout(function () {
                        if (currentConfig !== null) {
                            window.location.reload();
                        }
                    }, 250);
                });

                if (currentConfig === null) {
                    popup.classList.add('cookie-popup--is-sticky');
                    var checkedGroups = popup.querySelectorAll('input[type="checkbox"]:checked');

                    for (var i = 0; i < checkedGroups.length; i++) {
                        var allowedGroup = checkedGroups[i].name.replace('gdpr-', '');

                        if (allowedGroup !== '-' && allowedGroup !== '') {
                            var scripts = document.querySelectorAll('script[type="gdpr-blocker/' + allowedGroup + '"]');

                            for (var j = 0; j < scripts.length; j++) {
                                addScript(scripts[j].src, scripts[j].text);
                            }
                        }
                    }
                } else {
                    if (currentConfig !== '') {
                        var allowedGroups = currentConfig.split(',');
                        var checkedCheckboxes = popup.querySelectorAll('input[type="checkbox"]:checked');

                        for (var j = 0; j < checkedCheckboxes.length; j++) {
                            var name = checkedCheckboxes[j].name.replace('gdpr-', '');

                            if (allowedGroups.indexOf(name) === -1) {
                                checkedCheckboxes[j].checked = false;
                            }
                        }

                        for (var i = 0; i < allowedGroups.length; i++) {
                            var scripts = document.querySelectorAll('script[type="gdpr-blocker/' + allowedGroups[i] + '"]');
                            var checkbox = popup.querySelector('input[type="checkbox"][name="gdpr-' + allowedGroups[i] + '"]');

                            if (checkbox) {
                                checkbox.checked = true;
                            }

                            for (var j = 0; j < scripts.length; j++) {
                                addScript(scripts[j].src, scripts[j].text);
                            }
                        }
                    }
                }
            })();
        </script>
</body>
</html>
